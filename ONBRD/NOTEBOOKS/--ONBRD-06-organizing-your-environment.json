{"version":"7","defaultTimeframe":{"from":"now()-2h","to":"now()"},"defaultSegments":[],"sections":[{"id":"9f11edf3-9305-4e14-8093-1070aabdecab","type":"markdown","markdown":"# Organizing Your Environment\n\n> **Series:** ONBRD | **Notebook:** 6 of 10 | **Created:** December 2025\n\n## Tags, Segments, and Naming Conventions\n\nAs your Dynatrace environment grows, organization becomes critical. This notebook covers how to structure your environment with tags, segments, and naming conventions for maintainability and access control.\n\n---\n\n## Table of Contents\n\n1. Why Organization Matters\n2. Modern Organization Building Blocks\n3. Tagging with Host Properties and Cloud Tags\n4. Segments for Data Filtering\n5. Naming Conventions\n6. Querying by Tags and Properties\n7. Next Steps\n\n---\n\n## Prerequisites\n\n- Admin or Configurator access to Dynatrace\n- Entities discovered (hosts, services)\n- Understanding of your organizational structure"},{"id":"dda91524-4d64-41a2-adb7-1cb1950ace76","type":"markdown","markdown":"## 1. Why Organization Matters\n\nWithout organization, Dynatrace environments become difficult to manage:\n\n| Problem | Impact |\n|---------|--------|\n| **No structure** | Can't find entities quickly |\n| **No ownership** | Don't know who to contact |\n| **No access control** | Everyone sees everything |\n| **No filtering** | Dashboards show irrelevant data |\n| **No grouping** | Can't compare similar systems |\n\n### Modern Organization Building Blocks\n\n![Organization Hierarchy](../images/organization-hierarchy.svg)\n<!-- MARKDOWN_TABLE_ALTERNATIVE\n| Layer | Purpose |\n|-------|---------|\n| Policies & Permissions | Access control via IAM |\n| Segments | DQL-based data filtering |\n| Tags | Flexible grouping, set at source |\n| Naming Conventions | Consistency, discoverability |\n| Entities | Hosts, services, processes |\n-->\n\n> **Note:** The modern Dynatrace platform uses **Segments** for data filtering and **Policies** for access control. This replaces the legacy Management Zones approach."},{"id":"7e6bf3e1-ea39-41c4-91f1-6a7df4eac118","type":"markdown","markdown":"## 2. Modern Organization Building Blocks\n\nThe modern Dynatrace platform (Gen3/Grail) uses a \"tag at source\" approach rather than rule-based auto-tagging:\n\n### Tag Sources\n\n| Source | How It Works | Best For |\n|--------|--------------|----------|\n| **Host Properties** | Set via OneAgent configuration | Environment, team, tier metadata |\n| **Cloud Provider Tags** | Automatically imported from AWS/Azure/GCP | Cloud resource organization |\n| **Kubernetes Labels** | Imported from K8s metadata | Container workload organization |\n| **OpenTelemetry Attributes** | Set in instrumentation | Custom service attributes |\n\n### The \"Enrich at Source\" Philosophy\n\n![Modern Tagging Flow](../images/tagging-flow.svg)\n<!-- MARKDOWN_TABLE_ALTERNATIVE\n| Stage | Description |\n|-------|-------------|\n| Infrastructure | Cloud tags, K8s labels |\n| OneAgent | Host properties passed through |\n| Dynatrace (Grail) | Queryable attributes |\n-->\n\n### Why \"Tag at Source\"?\n\n| Benefit | Description |\n|---------|-------------|\n| **Consistent** | Same tags on metrics, logs, spans, and entities |\n| **Scalable** | No processing overhead to apply rules |\n| **Traceable** | Tags come from the source of truth |\n| **Real-time** | No delay waiting for rule evaluation |"},{"id":"fd1defc9-9169-4436-9142-e21c583b3689","type":"markdown","markdown":"## 3. Tagging with Host Properties and Cloud Tags\n\n### Host Properties (OneAgent)\n\nSet custom properties during OneAgent installation or via configuration:\n\n**During Installation:**\n```bash\n# Linux\nsudo /bin/sh Dynatrace-OneAgent.sh \\\n  --set-host-property=env=production \\\n  --set-host-property=team=platform \\\n  --set-host-property=tier=backend\n\n# Windows\n.\\Dynatrace-OneAgent.exe --set-host-property=env=production --set-host-property=team=checkout\n```\n\n**Via Configuration File:**\n```\n# /var/lib/dynatrace/oneagent/agent/config/hostcustomproperties.conf\nenv=production\nteam=platform\ncost-center=engineering\n```\n\n### Recommended Property Categories\n\n| Category | Example Properties | Purpose |\n|----------|-------------------|--------|\n| **Environment** | `env=prod`, `env=staging`, `env=dev` | Distinguish environments |\n| **Owner** | `team=platform`, `team=checkout` | Identify responsible team |\n| **Application** | `app=ecommerce`, `app=mobile-api` | Group by application |\n| **Cost Center** | `cost-center=marketing` | Financial allocation |\n| **Tier** | `tier=frontend`, `tier=backend` | Architecture layer |\n\n### Cloud Provider Tags\n\nCloud tags are automatically imported when using cloud integrations:\n\n| Cloud | Tag Format | DQL Field |\n|-------|-----------|-----------|\n| **AWS** | AWS resource tags | `aws.tag.*` |\n| **Azure** | Azure resource tags | `azure.tag.*` |\n| **GCP** | GCP labels | `gcp.label.*` |\n\n**AWS Tag Example:**\nIf your EC2 instance has tag `Environment=Production`, it appears as `aws.tag.Environment` in Dynatrace.\n\n### Kubernetes Labels\n\nK8s labels are automatically available for container workloads:\n\n| K8s Metadata | DQL Field |\n|--------------|-----------|\n| Namespace | `k8s.namespace.name` |\n| Deployment | `k8s.deployment.name` |\n| Pod labels | `k8s.pod.labels.*` |\n| Node labels | `k8s.node.labels.*` |"},{"id":"5d08bc93-c1a5-4a0a-a314-28d927edb4f1","type":"markdown","markdown":"## 4. Segments for Data Filtering\n\nSegments provide DQL-based filtering to create focused views of your data.\n\n**Location:** Observe and explore → Segments\n\n### What are Segments?\n\nSegments are reusable DQL filters that:\n- Filter data in Notebooks, Dashboards, and Apps\n- Can be applied as default context\n- Are shareable across the organization\n\n### Creating a Segment\n\n1. Go to Observe and explore → Segments\n2. Click \"Create segment\"\n3. Define your DQL filter:\n   ```dql\n   dt.entity.host.properties.env == \"production\"\n   ```\n4. Name your segment (e.g., \"Production Environment\")\n5. Save\n\n### Segment Use Cases\n\n| Use Case | Segment Filter | Purpose |\n|----------|---------------|---------|\n| **Environment** | `properties.env == \"prod\"` | Focus on production |\n| **Team** | `properties.team == \"checkout\"` | Team-specific view |\n| **Application** | `service.name contains \"payment\"` | Application focus |\n| **Region** | `aws.tag.Region == \"us-east-1\"` | Geographic filtering |\n\n### Segments vs Legacy Management Zones\n\n| Feature | Segments | Management Zones (Legacy) |\n|---------|----------|---------------------------|\n| **Filter basis** | DQL expressions | Rule-based matching |\n| **Data types** | All Grail data | Entities only |\n| **Flexibility** | Highly flexible | Limited rule types |\n| **Access control** | Use Policies instead | Built-in |\n| **Modern platform** | ✅ Recommended | ⚠️ Being deprecated |\n\n### Segment Best Practices\n\n| Practice | Why |\n|----------|-----|\n| **Use host properties** | Consistent filtering |\n| **Name clearly** | `Prod-Checkout-Team` not `Segment1` |\n| **Document purpose** | Add description |\n| **Test filters** | Verify expected data |"},{"id":"24e625fc-3db4-4933-a094-fa21d14c93e4","type":"markdown","markdown":"## 5. Naming Conventions\n\nConsistent naming makes entities discoverable and filtering effective.\n\n### Host Naming\n\nSet meaningful host names that encode key information:\n\n| Pattern | Example | Components |\n|---------|---------|------------|\n| `{env}-{tier}-{seq}` | `prod-web-01` | Environment, tier, sequence |\n| `{region}-{app}-{role}` | `us-east-ecom-api` | Region, app, role |\n| `{team}-{service}-{id}` | `checkout-cart-a1b2` | Team, service, unique ID |\n\n### Host Naming via OneAgent\n\nYou can set a custom display name during installation:\n\n```bash\nsudo /bin/sh Dynatrace-OneAgent.sh --set-host-name=\"prod-web-01\"\n```\n\n### Naming Principles\n\n| Principle | Good | Bad |\n|-----------|------|-----|\n| **Descriptive** | `payment-service` | `svc-001` |\n| **Consistent** | `prod-web-01`, `prod-web-02` | `prod-web-01`, `Web Server 2` |\n| **Parseable** | `us-east-prod-checkout` | `USEastProdCheckout` |\n| **Unique** | Include environment/region | Generic names |\n\n### Property Naming Standards\n\nFor host properties, use consistent naming:\n\n| Standard | Example | Why |\n|----------|---------|-----|\n| **Lowercase** | `env=prod` not `ENV=PROD` | Consistency |\n| **Hyphen separated** | `cost-center=eng` | Readability |\n| **Short keys** | `env` not `environment` | Query simplicity |\n| **Consistent values** | Always `prod` not sometimes `production` | Filtering works |"},{"id":"b7a82acd-98a9-48ad-9c1e-3ecb3f13da2a","type":"markdown","markdown":"## 6. Querying by Tags and Properties\n\nUse host properties and cloud tags in DQL queries to filter and group data."},{"id":"afb0e3b2-bb23-4212-bf9e-14fa884a1fa5","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"height":250,"state":{"input":{"timeframe":{"from":"now()-2h","to":"now()"},"value":"// Find hosts by name pattern\nfetch dt.entity.host\n| filter contains(entity.name, \"prod\")\n| fields entity.name\n| limit 20"},"visualizationSettings":{"table":{"hideColumnsForLargeResults":true},"autoSelectVisualization":true,"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table"}},{"id":"f11e7d83-dd18-4f18-8576-5f20605b48c7","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"height":250,"state":{"input":{"timeframe":{"from":"now()-2h","to":"now()"},"value":"// Count hosts by operating system type\nfetch dt.entity.host\n| summarize host_count = count(), by: {osType}\n| sort host_count desc"},"visualizationSettings":{"table":{"hideColumnsForLargeResults":true},"autoSelectVisualization":true,"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table"}},{"id":"f255ca51-196e-4843-90b9-4215d7d72df5","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"height":250,"state":{"input":{"timeframe":{"from":"now()-2h","to":"now()"},"value":"// Find services by name pattern\nfetch dt.entity.service\n| filter contains(entity.name, \"checkout\")\n| fields entity.name, serviceType\n| limit 20"},"visualizationSettings":{"table":{"hideColumnsForLargeResults":true},"autoSelectVisualization":true,"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table"}},{"id":"eac94941-e772-4d86-8833-328cd439584a","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"height":250,"state":{"input":{"timeframe":{"from":"now()-2h","to":"now()"},"value":"// Query logs filtered by host group (Kubernetes)\nfetch logs, from: now() - 1h\n| filter isNotNull(k8s.namespace.name)\n| summarize log_count = count(), by: {k8s.namespace.name}\n| sort log_count desc\n| limit 20"},"visualizationSettings":{"table":{"hideColumnsForLargeResults":true},"autoSelectVisualization":true,"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table"}},{"id":"6d89c694-aac2-48fb-ae08-b21ab6e681ce","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"height":250,"state":{"input":{"timeframe":{"from":"now()-2h","to":"now()"},"value":"// Query spans by service name pattern\nfetch spans, from: now() - 1h\n| filter span.kind == \"server\"\n| filter contains(service.name, \"payment\")\n| summarize request_count = count(), by: {service.name}\n| sort request_count desc\n| limit 20"},"visualizationSettings":{"table":{"hideColumnsForLargeResults":true},"autoSelectVisualization":true,"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table"}},{"id":"b154cb35-fa5f-40cc-b0eb-955703ff5750","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"height":250,"state":{"input":{"timeframe":{"from":"now()-2h","to":"now()"},"value":"// Find hosts by name pattern for environment identification\nfetch dt.entity.host\n| filter not(contains(entity.name, \"prod\"))\nand not(contains(entity.name, \"staging\"))\nand not(contains(entity.name, \"dev\"))\n| fields entity.name\n| limit 20"},"visualizationSettings":{"table":{"hideColumnsForLargeResults":true},"autoSelectVisualization":true,"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table"}},{"id":"0603acd7-dd24-4e76-b41e-94df3b25bfaf","type":"markdown","markdown":"## 7. Next Steps\n\nWith organization in place:\n\n1. **ONBRD-07: Understanding Your Data** - Explore what Dynatrace discovered\n2. Define host properties for your environment\n3. Create segments for team-specific views\n4. Document your naming conventions\n\n### Organization Checklist\n\n- [ ] Host property strategy documented\n- [ ] Properties set on OneAgent installations\n- [ ] Cloud tags verified (if using cloud providers)\n- [ ] Segments created for common filters\n- [ ] Naming conventions established\n- [ ] Access control configured via Policies (see ONBRD-02)\n\n---\n\n## Summary\n\nIn this notebook, you learned:\n\n- Why organization matters for scalability\n- The modern \"tag at source\" approach\n- How to use host properties and cloud tags\n- How to create and use Segments for filtering\n- Naming convention best practices\n- How to query by properties and attributes\n\n---\n\n## References\n\n- [Host Properties](https://docs.dynatrace.com/docs/setup-and-configuration/dynatrace-oneagent/installation-and-operation/linux/installation/customize-oneagent-installation-on-linux)\n- [Segments](https://docs.dynatrace.com/docs/observe-and-explore/segments)\n- [Cloud Tags](https://docs.dynatrace.com/docs/setup-and-configuration/setup-on-cloud-platforms)\n- [Kubernetes Labels](https://docs.dynatrace.com/docs/ingest-from/setup-on-k8s)\n- [DQL Reference](https://docs.dynatrace.com/docs/platform/grail/dynatrace-query-language)"}],"name":"--ONBRD-06-organizing-your-environment"}