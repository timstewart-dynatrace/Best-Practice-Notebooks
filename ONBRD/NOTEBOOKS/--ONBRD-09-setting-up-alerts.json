{"version":"7","defaultTimeframe":{"from":"now()-2h","to":"now()"},"defaultSegments":[],"sections":[{"id":"d2d3b3bc-aa99-4fb5-a721-90c49316dbcd","type":"markdown","markdown":"# Setting Up Alerts\n\n> **Series:** ONBRD | **Notebook:** 9 of 10 | **Created:** December 2025\n\n## Getting Notified When Things Go Wrong\n\nDynatrace's DAVIS AI automatically detects problems, but you need to configure where those alerts go. This notebook covers the Workflows app for modern alerting and notification routing.\n\n---\n\n## Table of Contents\n\n1. How DAVIS Problem Detection Works\n2. Modern Alerting with Workflows\n3. Creating Your First Workflow\n4. Notification Actions\n5. Routing Alerts to Teams\n6. Custom Metric Alerts\n7. Monitoring Your Alerts\n8. Next Steps\n\n---\n\n## Prerequisites\n\n- Configurator or Admin access\n- DQL fundamentals (ONBRD-08)\n- Access to notification target (email, Slack, PagerDuty, etc.)"},{"id":"32b54e12-064b-465e-b486-abdb85295b33","type":"markdown","markdown":"## 1. How DAVIS Problem Detection Works\n\nDAVIS AI continuously monitors your environment and creates **problems** when anomalies are detected:\n\n![DAVIS Problem Detection Flow](../images/davis-problem-flow.svg)\n<!-- MARKDOWN_TABLE_ALTERNATIVE\n| Stage | Description |\n|-------|-------------|\n| Data Sources | Metrics, Events, Logs |\n| DAVIS AI | Analysis and anomaly detection |\n| Problem Created | Issue identified |\n| Notification Sent | Teams alerted |\n| Root Cause Analysis | Automatic correlation |\n-->\n\n### Problem Types\n\n| Type | Trigger | Example |\n|------|---------|--------|\n| **Availability** | Service/process unavailable | Database crashed |\n| **Error rate** | Error rate increases | 500 errors spike |\n| **Slowdown** | Response time degradation | Latency increase |\n| **Resource** | CPU, memory, disk issues | Disk full |\n| **Custom** | Metric thresholds breached | Custom alert |"},{"id":"476be5de-a6ff-4fe0-be3e-a5485da08113","type":"markdown","markdown":"## 2. Modern Alerting with Workflows\n\nThe Workflows app is the modern platform's approach to alerting and automation.\n\n**Location:** Automate â†’ Workflows\n\n### What are Workflows?\n\nWorkflows are event-driven automations that can:\n- React to DAVIS problems\n- Send notifications to various channels\n- Execute remediation actions\n- Run on schedules\n\n![Workflow Architecture](../images/workflow-architecture.svg)\n<!-- MARKDOWN_TABLE_ALTERNATIVE\n| Stage | Description |\n|-------|-------------|\n| Trigger | Davis Event (problem opened/updated/closed) |\n| Conditions | Filtering logic |\n| Actions | Slack, Email, PagerDuty, Jira, Webhook, etc. |\n-->\n\n### Workflow vs Legacy Alerting Profiles\n\n| Feature | Workflows | Alerting Profiles (Legacy) |\n|---------|-----------|---------------------------|\n| **Trigger types** | Events, schedules, manual | Davis problems only |\n| **Filtering** | JavaScript expressions | Rule-based |\n| **Actions** | 20+ built-in actions | Fixed notifications |\n| **Automation** | Full automation capability | Notification only |\n| **Modern platform** | Recommended | Being deprecated |"},{"id":"758e185a-d34a-4817-b653-43bbeccf1aef","type":"markdown","markdown":"## 3. Creating Your First Workflow\n\n### Step 1: Open the Workflows App\n\n**Location:** Automate â†’ Workflows â†’ Create workflow\n\n### Step 2: Configure the Trigger\n\n1. Click \"Add trigger\"\n2. Select \"Davis problem\" trigger\n3. Configure trigger options:\n   - **Problem opens** - When a new problem is detected\n   - **Problem updates** - When problem details change\n   - **Problem closes** - When a problem is resolved\n\n### Step 3: Add Conditions (Optional)\n\nFilter which problems trigger the workflow:\n\n```javascript\n// Example: Only production problems\nevent[\"event.category\"] == \"AVAILABILITY\" \n  && event[\"affected_entity_ids\"].some(id => id.includes(\"prod\"))\n```\n\n### Step 4: Add Actions\n\n1. Click \"+\" to add an action\n2. Select action type (Slack, Email, PagerDuty, etc.)\n3. Configure the action parameters\n\n### Basic Workflow Example\n\n```\nTrigger: Davis problem opens\nCondition: event[\"event.category\"] == \"ERROR\"\nAction: Send Slack message to #alerts channel\n```\n\n### Workflow Settings\n\n| Setting | Description |\n|---------|-------------|\n| **Name** | Descriptive workflow name |\n| **Description** | What this workflow does |\n| **Owner** | User or service account |\n| **State** | Enabled/Disabled |"},{"id":"2a5d85c9-efc1-41ae-be53-d36ff022dbe8","type":"markdown","markdown":"## 4. Notification Actions\n\nWorkflows support multiple notification channels.\n\n### Built-in Notification Actions\n\n| Action | Use Case |\n|--------|----------|\n| **Send email** | Basic notifications |\n| **Send Slack message** | Team channels |\n| **Send Microsoft Teams message** | Team channels |\n| **Create PagerDuty incident** | On-call paging |\n| **Create ServiceNow incident** | Incident tickets |\n| **Create Jira issue** | Issue tracking |\n| **Send webhook** | Custom integrations |\n| **Create OpsGenie alert** | Alert management |\n\n### Setting Up Slack Notifications\n\n1. First, connect Slack to Dynatrace:\n   - Go to Settings â†’ Integration â†’ Slack\n   - Follow the OAuth flow to connect your workspace\n\n2. In your workflow, add a Slack action:\n   - Select channel\n   - Configure message template\n   - Use variables for dynamic content\n\n### Message Templates\n\nUse Jinja2 templates for dynamic messages:\n\n```\nðŸš¨ *Problem Detected*\n*Title:* {{ event[\"title\"] }}\n*Severity:* {{ event[\"event.category\"] }}\n*Status:* {{ event[\"event.status\"] }}\n*Link:* {{ event[\"problem_url\"] }}\n```\n\n### Setting Up Email Notifications\n\n1. Add \"Send email\" action to workflow\n2. Configure:\n   - Recipients (to, cc, bcc)\n   - Subject line (can use templates)\n   - Body content (HTML or plain text)\n\n### Setting Up PagerDuty\n\n1. Go to Settings â†’ Integration â†’ PagerDuty\n2. Configure your PagerDuty integration key\n3. Add \"Create PagerDuty incident\" action to workflow\n4. Map severity levels appropriately"},{"id":"7fd6d978-5bfb-4682-9b00-70311aecd57a","type":"markdown","markdown":"## 5. Routing Alerts to Teams\n\nUse workflow conditions to route alerts to the right teams.\n\n### Strategy: Condition-Based Routing\n\n![Alert Routing Example](../images/alert-routing.svg)\n<!-- MARKDOWN_TABLE_ALTERNATIVE\n| Filter | Destination |\n|--------|-------------|\n| Contains \"checkout\" | #alerts-checkout |\n| Contains \"payment\" | #alerts-payments |\n-->\n\n### Routing by Entity Name\n\n```javascript\n// Route checkout team alerts\nevent[\"affected_entity_ids\"].some(id => \n  id.toLowerCase().includes(\"checkout\")\n)\n```\n\n### Routing by Problem Category\n\n```javascript\n// Route availability issues to SRE\nevent[\"event.category\"] == \"AVAILABILITY\"\n\n// Route performance issues to app team\nevent[\"event.category\"] == \"SLOWDOWN\"\n```\n\n### Example Multi-Team Setup\n\n| Team | Workflow | Condition | Channel |\n|------|----------|-----------|---------|\n| Checkout | `checkout-alerts` | Entity contains \"checkout\" | Slack #alerts-checkout |\n| Payments | `payments-alerts` | Entity contains \"payment\" | PagerDuty Payments |\n| Platform | `critical-alerts` | Category == \"AVAILABILITY\" | PagerDuty Platform |\n\n### Creating Team-Specific Workflows\n\n1. Create one workflow per team/routing need\n2. Use conditions to filter problems\n3. Send to appropriate channel\n4. Include relevant context in message"},{"id":"2db33e63-1d6a-4f12-9a1d-cb6aed326fec","type":"markdown","markdown":"## 6. Custom Metric Alerts\n\nCreate alerts based on specific metric thresholds using the Davis analyzer in Workflows.\n\n### When to Use Custom Metric Alerts\n\n| Scenario | Configuration |\n|----------|---------------|\n| **Disk > 90%** | Static threshold |\n| **Queue depth spike** | Deviation from baseline |\n| **Business metric** | Custom metric threshold |\n| **SLO breach** | SLO burn rate |\n\n### Creating a Metric-Based Workflow\n\n1. Go to Automate â†’ Workflows\n2. Create new workflow\n3. Add trigger: \"Davis problem\" \n4. Add condition to filter for metric events\n5. Add notification action\n\n### Using Davis Analyzers\n\nDavis analyzers can detect anomalies in metrics:\n\n- **Static threshold** - Alert when value exceeds X\n- **Auto-adaptive baseline** - Alert on deviations from normal\n- **Seasonal patterns** - Account for time-based variations\n\n### Example: High CPU Alert\n\n1. Create workflow with Davis problem trigger\n2. Add condition:\n   ```javascript\n   event[\"title\"].includes(\"CPU\") && \n   event[\"event.category\"] == \"RESOURCE\"\n   ```\n3. Add Slack notification action"},{"id":"3ab2cd75-ff27-4b66-9116-9e20148d4652","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"height":250,"state":{"input":{"timeframe":{"from":"now()-2h","to":"now()"},"value":"// Recent problems\nfetch dt.davis.problems, from: now() - 24h\n| fields timestamp, display_id, title, status, affected_entity_types\n| sort timestamp desc\n| limit 20"},"visualizationSettings":{"table":{"hideColumnsForLargeResults":true},"autoSelectVisualization":true,"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table"}},{"id":"516f2ecc-3fd5-479c-9e1e-69ac93cbddc2","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"height":250,"state":{"input":{"timeframe":{"from":"now()-2h","to":"now()"},"value":"// Problem count by status\nfetch dt.davis.problems, from: now() - 7d\n| summarize count = count(), by: {status}\n| sort count desc"},"visualizationSettings":{"table":{"hideColumnsForLargeResults":true},"autoSelectVisualization":true,"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table"}},{"id":"f4b735cc-e65c-495e-a8ad-444e80c15e80","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"height":250,"state":{"input":{"timeframe":{"from":"now()-2h","to":"now()"},"value":"// Problems by day\nfetch dt.davis.problems, from: now() - 7d\n| fieldsAdd day = bin(timestamp, 1d)\n| summarize problem_count = count(), by: {day}\n| sort day desc"},"visualizationSettings":{"table":{"hideColumnsForLargeResults":true},"autoSelectVisualization":true,"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table"}},{"id":"0bb52504-33eb-4634-8839-8655749f9ff6","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"height":250,"state":{"input":{"timeframe":{"from":"now()-2h","to":"now()"},"value":"// Active problems right now\nfetch dt.davis.problems, from: now() - 30d\n| filter status == \"OPEN\"\n| fields timestamp, display_id, title, affected_entity_types\n| sort timestamp desc"},"visualizationSettings":{"table":{"hideColumnsForLargeResults":true},"autoSelectVisualization":true,"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table"}},{"id":"83e3ff33-8e14-4d33-8e12-bc15921480dc","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"height":250,"state":{"input":{"timeframe":{"from":"now()-2h","to":"now()"},"value":"// Problem duration analysis\nfetch dt.davis.problems, from: now() - 7d\n| filter status == \"CLOSED\"\n| filter isNotNull(end_time)\n| fieldsAdd duration_minutes = (end_time - timestamp) / 60000000000\n| summarize\navg_duration = avg(duration_minutes),\nmax_duration = max(duration_minutes),\nproblem_count = count()"},"visualizationSettings":{"table":{"hideColumnsForLargeResults":true},"autoSelectVisualization":true,"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table"}},{"id":"7b04da9f-5973-40a5-9e88-e192fa9fdb8b","type":"markdown","markdown":"### Alert Testing Checklist\n\nAfter configuring workflows:\n\n1. **Test notification delivery** - Use workflow test feature\n2. **Verify routing** - Confirm correct channels receive alerts\n3. **Check formatting** - Review message content\n4. **Validate conditions** - Ensure filters work as expected\n5. **Test resolution** - Confirm close notifications work\n\n### Workflow Execution History\n\nView workflow runs in:\n- Automate â†’ Workflows â†’ Select workflow â†’ Executions\n\nCheck for:\n- Successful runs\n- Failed runs with error details\n- Action outputs"},{"id":"e5b118c5-f803-4878-aecb-000a0d643706","type":"markdown","markdown":"## 8. Next Steps\n\nWith alerting configured:\n\n1. **ONBRD-10: Building Dashboards** - Visualize your data\n2. Fine-tune workflow conditions based on alert volume\n3. Set up escalation paths with multiple workflows\n4. Document on-call procedures\n\n### Alerting Checklist\n\n- [ ] Slack/Email integration configured\n- [ ] First workflow created and tested\n- [ ] Team-specific workflows configured\n- [ ] Test notifications sent successfully\n- [ ] Critical path to on-call established\n- [ ] Escalation procedures documented\n\n---\n\n## Summary\n\nIn this notebook, you learned:\n\n- How DAVIS problem detection works\n- How to create workflows for alerting\n- How to configure notification actions\n- How to route alerts to teams using conditions\n- How to create custom metric alerts\n- How to monitor workflow effectiveness\n\n---\n\n## References\n\n- [Problem Detection](https://docs.dynatrace.com/docs/platform/davis-ai/basics/problem-detection)\n- [Workflows](https://docs.dynatrace.com/docs/platform-modules/automations/workflows)\n- [Workflow Actions](https://docs.dynatrace.com/docs/platform-modules/automations/workflows/actions)\n- [Slack Integration](https://docs.dynatrace.com/docs/platform-modules/automations/workflows/actions/slack)\n- [PagerDuty Integration](https://docs.dynatrace.com/docs/platform-modules/automations/workflows/actions/pagerduty)"}],"name":"--ONBRD-09-setting-up-alerts"}