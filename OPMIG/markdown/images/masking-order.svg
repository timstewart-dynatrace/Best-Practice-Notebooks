<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 320">
  <defs>
    <linearGradient id="unsafeGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#ef4444;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#dc2626;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="safeGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#22c55e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#16a34a;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="maskingGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:1" />
    </linearGradient>
    <filter id="moShadow">
      <feDropShadow dx="1" dy="1" stdDeviation="2" flood-opacity="0.15"/>
    </filter>
    <marker id="moArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="800" height="320" fill="#f8f9fa" rx="10"/>

  <!-- Title -->
  <text x="400" y="28" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333" text-anchor="middle">Masking Executes First</text>
  <text x="400" y="48" font-family="Arial, sans-serif" font-size="11" fill="#666" text-anchor="middle">Sensitive data is protected before any other processing</text>

  <!-- Input -->
  <rect x="30" y="75" width="160" height="100" rx="8" fill="#fecaca" stroke="#ef4444" stroke-width="2" filter="url(#moShadow)"/>
  <text x="110" y="100" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#dc2626" text-anchor="middle">Incoming Log</text>
  <text x="110" y="120" font-family="monospace" font-size="10" fill="#7f1d1d" text-anchor="middle">card: 4111-1111-1111-1111</text>
  <text x="110" y="135" font-family="monospace" font-size="10" fill="#7f1d1d" text-anchor="middle">email: user@example.com</text>
  <text x="110" y="150" font-family="monospace" font-size="10" fill="#7f1d1d" text-anchor="middle">ssn: 123-45-6789</text>
  <text x="110" y="165" font-family="Arial, sans-serif" font-size="10" fill="#dc2626" text-anchor="middle">⚠️ Contains PII</text>

  <path d="M190,125 L230,125" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#moArrow)"/>

  <!-- Step 1: Masking -->
  <rect x="240" y="70" width="150" height="110" rx="8" fill="url(#maskingGrad)" filter="url(#moShadow)"/>
  <text x="315" y="95" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white" text-anchor="middle">1. MASKING</text>
  <text x="315" y="115" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)" text-anchor="middle">Credit Cards</text>
  <text x="315" y="130" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)" text-anchor="middle">Emails</text>
  <text x="315" y="145" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)" text-anchor="middle">SSN</text>
  <text x="315" y="165" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.8)" text-anchor="middle">Runs FIRST always</text>

  <path d="M390,125 L420,125" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#moArrow)"/>

  <!-- Masked Log -->
  <rect x="430" y="75" width="160" height="100" rx="8" fill="#d1fae5" stroke="#22c55e" stroke-width="2" filter="url(#moShadow)"/>
  <text x="510" y="100" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#047857" text-anchor="middle">Masked Log</text>
  <text x="510" y="120" font-family="monospace" font-size="10" fill="#047857" text-anchor="middle">card: [CC_REDACTED]</text>
  <text x="510" y="135" font-family="monospace" font-size="10" fill="#047857" text-anchor="middle">email: [EMAIL_REDACTED]</text>
  <text x="510" y="150" font-family="monospace" font-size="10" fill="#047857" text-anchor="middle">ssn: [SSN_REDACTED]</text>
  <text x="510" y="165" font-family="Arial, sans-serif" font-size="10" fill="#047857" text-anchor="middle">✅ PII Protected</text>

  <path d="M590,125 L620,125" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#moArrow)"/>

  <!-- Remaining Stages -->
  <rect x="630" y="70" width="140" height="110" rx="8" fill="#fff" stroke="#e2e8f0" stroke-width="2"/>
  <text x="700" y="95" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#333" text-anchor="middle">2-6. Remaining</text>
  <text x="700" y="115" font-family="Arial, sans-serif" font-size="10" fill="#666" text-anchor="middle">Drop (safe)</text>
  <text x="700" y="130" font-family="Arial, sans-serif" font-size="10" fill="#666" text-anchor="middle">Process (safe)</text>
  <text x="700" y="145" font-family="Arial, sans-serif" font-size="10" fill="#666" text-anchor="middle">Extract (safe)</text>
  <text x="700" y="160" font-family="Arial, sans-serif" font-size="10" fill="#666" text-anchor="middle">Store (safe)</text>

  <!-- Compliance Section -->
  <rect x="30" y="200" width="740" height="105" rx="8" fill="#fff" stroke="#e2e8f0" stroke-width="2"/>
  <text x="400" y="225" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333" text-anchor="middle">Compliance Benefits</text>

  <rect x="50" y="240" width="160" height="50" rx="6" fill="#fecaca"/>
  <text x="130" y="260" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#dc2626" text-anchor="middle">PCI-DSS</text>
  <text x="130" y="278" font-family="Arial, sans-serif" font-size="10" fill="#7f1d1d" text-anchor="middle">Card numbers never stored</text>

  <rect x="230" y="240" width="160" height="50" rx="6" fill="#fef3c7"/>
  <text x="310" y="260" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#92400e" text-anchor="middle">GDPR</text>
  <text x="310" y="278" font-family="Arial, sans-serif" font-size="10" fill="#78350f" text-anchor="middle">Email/IP addresses masked</text>

  <rect x="410" y="240" width="160" height="50" rx="6" fill="#dbeafe"/>
  <text x="490" y="260" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#1e40af" text-anchor="middle">HIPAA</text>
  <text x="490" y="278" font-family="Arial, sans-serif" font-size="10" fill="#1e3a5f" text-anchor="middle">PHI never exposed</text>

  <rect x="590" y="240" width="160" height="50" rx="6" fill="#d1fae5"/>
  <text x="670" y="260" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#047857" text-anchor="middle">SOC 2</text>
  <text x="670" y="278" font-family="Arial, sans-serif" font-size="10" fill="#064e3b" text-anchor="middle">Secrets protected</text>
</svg>
