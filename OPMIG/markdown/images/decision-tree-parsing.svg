<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 650">
  <defs>
    <linearGradient id="problemGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ef4444;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#dc2626;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="stepGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2563eb;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="yesGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="noGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#d97706;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="fixGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:1" />
    </linearGradient>
    <filter id="dtShadow">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.15"/>
    </filter>
    <marker id="dtArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
    <marker id="yesArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#10b981"/>
    </marker>
    <marker id="noArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#f59e0b"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="800" height="650" fill="#0f172a" rx="10"/>

  <!-- Title -->
  <text x="400" y="35" font-family="system-ui, -apple-system, sans-serif" font-size="20" font-weight="bold" fill="#f1f5f9" text-anchor="middle">Decision Tree 2: Parsing Failures</text>

  <!-- Problem Box -->
  <rect x="250" y="55" width="300" height="45" rx="8" fill="url(#problemGrad)" filter="url(#dtShadow)"/>
  <text x="400" y="83" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" fill="#fff" text-anchor="middle">Fields not extracted from log content</text>

  <!-- Arrow to Step 1 -->
  <line x1="400" y1="100" x2="400" y2="125" stroke="#64748b" stroke-width="2" marker-end="url(#dtArrow)"/>

  <!-- Step 1 -->
  <rect x="200" y="130" width="400" height="50" rx="8" fill="url(#stepGrad)" filter="url(#dtShadow)"/>
  <circle cx="230" cy="155" r="15" fill="rgba(255,255,255,0.2)"/>
  <text x="230" y="161" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" fill="#fff" text-anchor="middle">1</text>
  <text x="420" y="150" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="#fff" text-anchor="middle">Is the parse processor running?</text>
  <text x="420" y="168" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)" text-anchor="middle">Query: fetch logs | fields content, status_code</text>

  <!-- Step 1 Branches -->
  <line x1="300" y1="180" x2="300" y2="210" stroke="#10b981" stroke-width="2"/>
  <line x1="300" y1="210" x2="180" y2="210" stroke="#10b981" stroke-width="2" marker-end="url(#yesArrow)"/>
  <text x="240" y="205" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#10b981">✓ EXISTS</text>

  <line x1="500" y1="180" x2="500" y2="210" stroke="#f59e0b" stroke-width="2"/>
  <line x1="500" y1="210" x2="620" y2="210" stroke="#f59e0b" stroke-width="2" marker-end="url(#noArrow)"/>
  <text x="560" y="205" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#f59e0b">✗ MISSING</text>

  <!-- Yes Path - Go to Step 2 -->
  <rect x="50" y="220" width="130" height="35" rx="6" fill="url(#yesGrad)"/>
  <text x="115" y="242" font-family="system-ui, sans-serif" font-size="11" fill="#fff" text-anchor="middle">Go to Step 2 ↓</text>

  <!-- No Path - Fix Box -->
  <rect x="620" y="195" width="160" height="90" rx="6" fill="url(#fixGrad)" filter="url(#dtShadow)"/>
  <text x="700" y="215" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#fff" text-anchor="middle">Parser Not Running</text>
  <text x="630" y="235" font-family="system-ui, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)">• Pipeline order correct?</text>
  <text x="630" y="250" font-family="system-ui, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)">• Processor enabled?</text>
  <text x="630" y="265" font-family="system-ui, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)">• Condition matching?</text>
  <text x="630" y="280" font-family="system-ui, sans-serif" font-size="10" fill="#fcd34d">→ Enable &amp; reorder</text>

  <!-- Step 2 -->
  <line x1="115" y1="255" x2="115" y2="295" stroke="#64748b" stroke-width="2" marker-end="url(#dtArrow)"/>
  <rect x="30" y="300" width="380" height="50" rx="8" fill="url(#stepGrad)" filter="url(#dtShadow)"/>
  <circle cx="60" cy="325" r="15" fill="rgba(255,255,255,0.2)"/>
  <text x="60" y="331" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" fill="#fff" text-anchor="middle">2</text>
  <text x="230" y="320" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="#fff" text-anchor="middle">Does DPL pattern match log format?</text>
  <text x="230" y="338" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)" text-anchor="middle">Test pattern with sample log in DQL</text>

  <!-- Step 2 Branches -->
  <line x1="130" y1="350" x2="130" y2="380" stroke="#10b981" stroke-width="2"/>
  <line x1="130" y1="380" x2="60" y2="380" stroke="#10b981" stroke-width="2" marker-end="url(#yesArrow)"/>
  <text x="95" y="375" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#10b981">✓</text>

  <line x1="290" y1="350" x2="290" y2="380" stroke="#f59e0b" stroke-width="2"/>
  <line x1="290" y1="380" x2="360" y2="380" stroke="#f59e0b" stroke-width="2" marker-end="url(#noArrow)"/>
  <text x="325" y="375" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#f59e0b">✗</text>

  <!-- Yes - Go to Step 3 -->
  <rect x="20" y="390" width="80" height="30" rx="6" fill="url(#yesGrad)"/>
  <text x="60" y="410" font-family="system-ui, sans-serif" font-size="10" fill="#fff" text-anchor="middle">Step 3 ↓</text>

  <!-- No - Pattern Issue -->
  <rect x="360" y="365" width="160" height="85" rx="6" fill="url(#fixGrad)" filter="url(#dtShadow)"/>
  <text x="440" y="385" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#fff" text-anchor="middle">Pattern Issue</text>
  <text x="370" y="402" font-family="system-ui, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)">• Log format changed?</text>
  <text x="370" y="417" font-family="system-ui, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)">• Extra whitespace?</text>
  <text x="370" y="432" font-family="system-ui, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)">• Optional fields?</text>
  <text x="370" y="447" font-family="system-ui, sans-serif" font-size="10" fill="#fcd34d">→ Update DPL pattern</text>

  <!-- Step 3 -->
  <line x1="60" y1="420" x2="60" y2="460" stroke="#64748b" stroke-width="2" marker-end="url(#dtArrow)"/>
  <rect x="30" y="465" width="340" height="50" rx="8" fill="url(#stepGrad)" filter="url(#dtShadow)"/>
  <circle cx="60" cy="490" r="15" fill="rgba(255,255,255,0.2)"/>
  <text x="60" y="496" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" fill="#fff" text-anchor="middle">3</text>
  <text x="210" y="485" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="#fff" text-anchor="middle">Are field names valid?</text>
  <text x="210" y="503" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)" text-anchor="middle">Check reserved words, special chars</text>

  <!-- Step 3 Branches -->
  <line x1="130" y1="515" x2="130" y2="545" stroke="#10b981" stroke-width="2"/>
  <line x1="130" y1="545" x2="60" y2="545" stroke="#10b981" stroke-width="2" marker-end="url(#yesArrow)"/>
  <text x="95" y="540" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#10b981">✓</text>

  <line x1="250" y1="515" x2="250" y2="545" stroke="#f59e0b" stroke-width="2"/>
  <line x1="250" y1="545" x2="320" y2="545" stroke="#f59e0b" stroke-width="2" marker-end="url(#noArrow)"/>
  <text x="285" y="540" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#f59e0b">✗</text>

  <!-- Yes - Go to Step 4 -->
  <rect x="20" y="555" width="80" height="30" rx="6" fill="url(#yesGrad)"/>
  <text x="60" y="575" font-family="system-ui, sans-serif" font-size="10" fill="#fff" text-anchor="middle">Step 4 ↓</text>

  <!-- No - Naming Issue -->
  <rect x="320" y="530" width="155" height="70" rx="6" fill="url(#fixGrad)" filter="url(#dtShadow)"/>
  <text x="397" y="550" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#fff" text-anchor="middle">Naming Issue</text>
  <text x="330" y="567" font-family="system-ui, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)">• Use underscores</text>
  <text x="330" y="582" font-family="system-ui, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)">• Avoid reserved words</text>
  <text x="330" y="597" font-family="system-ui, sans-serif" font-size="10" fill="#fcd34d">→ Rename fields</text>

  <!-- Step 4 -->
  <line x1="60" y1="585" x2="60" y2="605" stroke="#64748b" stroke-width="2" marker-end="url(#dtArrow)"/>
  <rect x="30" y="610" width="340" height="30" rx="8" fill="url(#stepGrad)" filter="url(#dtShadow)"/>
  <circle cx="60" cy="625" r="12" fill="rgba(255,255,255,0.2)"/>
  <text x="60" y="630" font-family="system-ui, sans-serif" font-size="12" font-weight="bold" fill="#fff" text-anchor="middle">4</text>
  <text x="210" y="630" font-family="system-ui, sans-serif" font-size="12" font-weight="bold" fill="#fff" text-anchor="middle">Are values in expected format?</text>

  <!-- Step 4 Branches -->
  <rect x="400" y="610" width="100" height="30" rx="6" fill="url(#yesGrad)"/>
  <text x="450" y="630" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#fff" text-anchor="middle">✓ Success!</text>

  <rect x="520" y="610" width="140" height="30" rx="6" fill="url(#fixGrad)"/>
  <text x="590" y="630" font-family="system-ui, sans-serif" font-size="10" fill="#fff" text-anchor="middle">✗ Add type conversion</text>

  <!-- Arrows to final boxes -->
  <line x1="370" y1="625" x2="395" y2="625" stroke="#10b981" stroke-width="2" marker-end="url(#yesArrow)"/>
  <line x1="500" y1="625" x2="515" y2="625" stroke="#f59e0b" stroke-width="2" marker-end="url(#noArrow)"/>
</svg>
